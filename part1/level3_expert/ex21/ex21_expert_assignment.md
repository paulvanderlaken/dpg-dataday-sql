# Exercise 21: Customer Cohort Revenue Growth

**Track & Level:** Expert  
**Difficulty:** 5  
**Objective:** Define customer cohorts by first-purchase month and compute both monthly and cumulative revenue per cohort  
**Dataset/Table(s):** SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.CUSTOMER, ORDERS, LINEITEM

## Problem Statement
Your retention analytics team wants to understand how different customer acquisition cohorts perform over time. Define each cohort as the month of a customer’s first order. Then, for each cohort and each subsequent month, compute:
1. The total revenue generated by that cohort in the month.
2. The running cumulative revenue for the cohort up to that month.

Return the columns:
- `cohort_month` (YYYY-MM-01)
- `revenue_month` (YYYY-MM-01)
- `cohort_month_revenue`
- `cumulative_cohort_revenue`

## Learner View – Starter SQL (optional)
```sql
-- starter code
SELECT
  DATE_TRUNC('MONTH', MIN(o.O_ORDERDATE)) AS cohort_month,
  DATE_TRUNC('MONTH', o.O_ORDERDATE)      AS revenue_month,
  SUM(l.L_EXTENDEDPRICE * (1 - l.L_DISCOUNT)) AS revenue
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.ORDERS o
JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.LINEITEM l
  ON o.O_ORDERKEY = l.L_ORDERKEY
GROUP BY 1, 2;
```

## Expected Concepts:
* Common Table Expressions (CTEs)
* Date bucketing (DATE_TRUNC)
* Joins and aggregation
* Window functions for cumulative sums

## ex05: High-Quantity or Low-Price Lineitems

> **Type:** Core  
> **Difficulty:** 2 / 10

### Business context
The promotions team is reviewing order data to identify line items that might qualify for volume-based discounts or price-based promotions. They want to flag any line items that either had a large quantity ordered or a relatively low total price â€” both indicators of bulk buying or budget-sensitive purchases.

### Starter query
```sql
-- Inspect the LINEITEM table
SELECT *
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.LINEITEM
LIMIT 10;
```

### Required datasets

* `SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.LINEITEM`

<details>
<summary>ðŸ’¡ Hint (click to expand)</summary>

#### How to think about it

This task requires filtering line items based on *either* a high quantity or a low price. Use logical operators like `OR` to combine your conditions. Think about where to place parentheses for clarity and correctness.

#### Helpful SQL concepts

`WHERE`, `AND`, `OR`

```sql
SELECT â€¦ FROM â€¦ WHERE column1 > value1 OR column2 < value2;
```

</details>

<details>
<summary>âœ… Solution (click to expand)</summary>

#### Working query

```sql
SELECT
    L_ORDERKEY,
    L_QUANTITY,
    L_EXTENDEDPRICE,
    L_DISCOUNT
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.LINEITEM
WHERE L_QUANTITY > 50 OR L_EXTENDEDPRICE < 10000;
```

Of course you can have used different demarcations for what you would consider _high_ quantity or _low_ price. 

#### Why this works

This query returns line items where the quantity exceeds 50 units **or** the total price is below $10,000. The `OR` operator ensures that either condition is sufficient for inclusion. This helps the team screen both bulk and low-cost purchases in one pass.

#### Business answer

The extracted line items represent candidates for discount analysis due to their high volume or low pricing.

#### Take-aways

* Combine filters using `OR` when multiple paths to inclusion are valid.
* Always group filters clearly to avoid unintended logic.
* Filtering logic helps focus only on actionable data rows.

</details>

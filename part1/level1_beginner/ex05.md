## ex05: High-Quantity or Low-Price Lineitems

> **Type:** Core  
> **Difficulty:** 2 / 10

### Business context
The sales operations team is designing a new bulk discount program and wants to analyze which line items might already qualify. To identify candidates, they want to find all order line items that either involve large quantities or come at a low extended price. These entries may signal wholesale behavior or underpriced items worth reevaluating.

### Starter query
```sql
-- Explore the structure of line item records
SELECT
    L_ORDERKEY,
    L_PARTKEY,
    L_QUANTITY,
    L_EXTENDEDPRICE,
    L_DISCOUNT
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.LINEITEM
LIMIT 10;
```

### Required datasets

* `SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.LINEITEM`

<details>
<summary>ðŸ’¡ Hint (click to expand)</summary>

#### How to think about it

You need to return rows that satisfy *either* of two conditionsâ€”this calls for using the `OR` operator in your `WHERE` clause. Make sure the logic reflects the correct grouping (i.e., donâ€™t accidentally create an unintended filter combination). If you're checking for high quantity or low price, think carefully about thresholds that make sense.

#### Helpful SQL concepts

`WHERE`, `AND`, `OR`

```sql
SELECT â€¦ FROM â€¦ WHERE condition1 OR condition2;
```

</details>

<details>
<summary>âœ… Solution (click to expand)</summary>

#### Working query

```sql
SELECT
    L_ORDERKEY,
    L_PARTKEY,
    L_QUANTITY,
    L_EXTENDEDPRICE,
    L_DISCOUNT
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.LINEITEM
WHERE L_QUANTITY >= 50
   OR L_EXTENDEDPRICE < 10000;
```

You likely have used different values for filtering. These are just examples, using the maximum quantity and a relatively low price in this dataset.

#### Why this works

This query filters the `LINEITEM` table to include rows where either the ordered quantity is 50 or more, or the extended price is below $10,000. These thresholds can be treated as indicative of bulk orders or unusually low pricing. Using `OR` ensures that either condition suffices for inclusion.

#### Business answer

Line items with high quantity or low price have been identifiedâ€”these can inform future discounting and pricing policies.

#### Take-aways

* Logical operators like `OR` help define flexible conditions for business rules.
* Always check operator precedence and use parentheses if combining `AND` and `OR`.
* Filtering conditions should be tied to meaningful business thresholdsâ€”not arbitrary values.

</details>

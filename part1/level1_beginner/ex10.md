## ex10: Compute Price + Tax

> **Type:** Stretch  
>
> **Difficulty:** 2 / 10

### Business context
Finance is finalizing quarterly reporting and needs to understand how taxes affect gross sales. To aid analysis, theyâ€™ve requested an overview of all order, part, supplier combinations with prices before and after applying a 15% sales tax. By default, prices in the TPCH dataset reflects pre-tax prices. Can you produce them this overview?

### Starter query
```sql
-- Previewing line item pricing fields
SELECT *
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.LINEITEM
LIMIT 10;
```

### Required datasets

* `SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.LINEITEM`

<details>
<summary>ðŸ’¡ Hint (click to expand)</summary>

#### How to think about it

Use a basic arithmetic expression to increase the extended price by 15%. Since `L_EXTENDEDPRICE` represents the base price, you can multiply it by 1.15 to simulate a 15% tax. Include both the original and the taxed price in your output for comparison.

#### Helpful SQL concepts

`Arithmetic in SELECT`

```sql
SELECT column, column * 1.15 AS taxed_value FROM â€¦;
```

</details>

<details>
<summary>âœ… Solution (click to expand)</summary>

#### Working query

```sql
SELECT
    L_ORDERKEY,
    L_PARTKEY,
    L_SUPPKEY,
    L_EXTENDEDPRICE,
    L_EXTENDEDPRICE * 1.15 AS PRICE_WITH_TAX
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.LINEITEM;
```

#### Why this works

This query selects the original extended price for each line item and calculates a new column that increases it by 15% using a simple multiplication (`L_EXTENDEDPRICE * 1.15`). SQL expressions inside `SELECT` are evaluated row by row, so this is both readable and efficient.

#### Business answer

We can now see the hypothetical taxed price for every line item, helping finance estimate taxed revenue totals for policy simulation.

#### Take-aways

* SQL supports arithmetic directly in the `SELECT` clause.
* You can alias computed columns to improve readability.
* Always use decimal multiplication for percentage adjustments to avoid rounding errors.

</details>

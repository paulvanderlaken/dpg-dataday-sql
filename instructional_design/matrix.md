# Full-Day SQL Workshop Matrix – Core & Stretch Paths

## Part 1

#### Beginner

| Ex # | Title                                | Business Question                                                                                  | SQL Concept                      | Difficulty | Dataset Familiarity Focus                                | Track    | Core/Stretch | Stretch/Core Notes                                                  |
|:----:|--------------------------------------|----------------------------------------------------------------------------------------------------|----------------------------------|:----------:|----------------------------------------------------------|----------|:-------------:|------------------------------------------------------------------------|
| ex01 | Top 10 Customers by Balance          | “Which customers should we prioritize for a loyalty program based on balances?”                   | `SELECT` + `ORDER BY` + `LIMIT`  |     2      | **CUSTOMER**: C_CUSTKEY, C_NAME, C_ACCTBAL                | Part 1   | Core         | Introduces sorting and value-based prioritization                   |
| ex02 | Filter Customers by Market Segment   | “Which clients operate in the BUILDING segment for a tailored campaign?”                          | `WHERE` (equality)               |     1      | **CUSTOMER**: C_MKTSEG                                   | Part 1   | Core         | First exposure to filtering                                         |
| ex03 | Orders in Q1 1995                    | “What was order activity in Q1 1995 to audit seasonal demand?”                                    | `WHERE` (date filter, `BETWEEN`) |     2      | **ORDERS**: O_ORDERDATE, O_ORDERKEY, O_CUSTKEY           | Part 1   | Core         | Adds date filter logic                                              |
| ex04 | Project Part Attributes              | “What are the key attributes of our current parts catalog?”                                       | Column projection                |     1      | **PART**: P_PARTKEY, P_NAME, P_SIZE                      | Part 1   | Core         | Simple projection; introduces PART table                            |
| ex05 | High-Quantity or Low-Price Lineitems | “Which line items qualify for bulk discounts or promotions?”                                      | `WHERE` with `AND/OR`            |     2      | **LINEITEM**: L_QUANTITY, L_EXTENDEDPRICE, L_DISCOUNT    | Part 1   | Core         | Filtering using logical operators                                   |
| ex06 | Sample Five Parts                    | “Show any five parts for a quick sanity check.”                                                   | `LIMIT`                          |     1      | **PART**: quick sampling of P_PARTKEY, P_NAME            | Part 1   | Stretch      | Reinforces `LIMIT` without ordering                                 |
| ex07 | Sort Parts by Size and Name          | “List parts sorted by size then alphabetically.”                                                  | `ORDER BY` multiple columns      |     2      | **PART**: P_SIZE, P_NAME                                 | Part 1   | Stretch      | Builds on ex01 + ex04                                               |
| ex08 | Nations Starting with “U”            | “Which countries begin with ‘U’?”                                                                 | `LIKE` (pattern matching)        |     2      | **NATION**: N_NAME, N_NATIONKEY                          | Part 1   | Stretch      | Pattern matching with LIKE                                          |
| ex09 | Suppliers with Missing Comments      | “Identify suppliers lacking commentary.”                                                          | `IS NULL` / `IS NOT NULL`        |     1      | **SUPPLIER**: S_SUPPKEY, S_NAME, S_COMMENT                | Part 1   | Stretch      | Introduces NULL logic                                               |
| ex10 | Compute Price + Tax                  | “What would each line item cost including a 5% tax?”                                              | Arithmetic in `SELECT`           |     2      | **LINEITEM**: L_EXTENDEDPRICE, basic math expr           | Part 1   | Stretch      | Applies calculations in SELECT                                      |

----

#### Advanced

| Ex # | Title                                  | Business Question                                                                                      | SQL Concept                           | Difficulty | Dataset Familiarity Focus                                             | Track    | Core/Stretch | Stretch/Core Notes                                                  |
|:----:|----------------------------------------|--------------------------------------------------------------------------------------------------------|---------------------------------------|:----------:|------------------------------------------------------------------------|----------|:-------------:|------------------------------------------------------------------------|
| ex11 | Total Sales per Part                   | “Which parts generated the most revenue last month?”                                                  | `GROUP BY` + `SUM`                    |     3      | **LINEITEM** → P_PARTKEY aggregation                                  | Part 1   | Core         | Introduces aggregation and grouping                                  |
| ex12 | Parts with Sales ≥ X                   | “Which parts sold ≥ 1,000 units for bulk pricing?”                                                    | `HAVING` on aggregates                |     4      | **LINEITEM** + filter on aggregated L_QUANTITY                        | Part 1   | Core         | Builds on ex11 with filter-on-aggregate                              |
| ex13 | Join Orders to Customers               | “Show customer details alongside their orders.”                                                       | `INNER JOIN`                          |     3      | **ORDERS** ↔ **CUSTOMER**                                            | Part 1   | Core         | First introduction to joining tables                                 |
| ex14 | Lineitems ↔ Orders ↔ Parts Cascade     | “Build a full order-detail feed.”                                                                     | Multi-table `JOIN`                    |     4      | **LINEITEM**, **ORDERS**, **PART**                                   | Part 1   | Core         | Joins 3 tables; preps for business reporting                         |
| ex15 | Customers with Latest Order Date       | “Find each customer’s most recent order date.”                                                        | Subquery in `FROM`                    |     5      | **CUSTOMER** joined to max O_ORDERDATE in **ORDERS**                | Part 1   | Core         | Subqueries in FROM clause; supports recency logic                    |
| ex16 | Rank Orders by Date                    | “Assign a rank to orders per customer to highlight their first.”                                      | `ROW_NUMBER()` OVER ()                |     6      | **ORDERS**: time ordering, window framing                             | Part 1   | Core         | Preps for ranking and window patterns                                |
| ex17 | Supplier Part List via CTE             | “Generate a cleaned supplier-part list.”                                                              | `WITH` / CTE                          |     5      | **PARTSUPP** joined to **PART** & **SUPPLIER**                       | Part 1   | Stretch      | CTE as aliasing or simplification                                    |
| ex18 | Nation Name via Subquery               | “Retrieve region name alongside country count using subquery.”                                        | Scalar subquery in `SELECT`          |     5      | **REGION** → **NATION**                                              | Part 1   | Stretch      | Alternate to JOIN in SELECT clause                                   |
| ex19 | Top 5 Discounts per Order              | “Which 5 line items got the steepest discount per order?”                                             | `RANK()` + `PARTITION BY`            |     6      | **LINEITEM** partitioned by L_ORDERKEY                               | Part 1   | Stretch      | Builds on ex16 with denser partitioning                              |
| ex20 | Rolling Sum of Sales per Day           | “Show daily cumulative sales.”                                                                        | `SUM() OVER (ORDER BY)`              |     6      | **LINEITEM** + O_ORDERDATE via join                                  | Part 1   | Stretch      | Time-aware cumulative logic                                          |

---

#### Expert

| Ex # | Title                                              | Business Question                                                                                                                                           | SQL Concepts                                                                                               | Difficulty | Dataset Familiarity Focus                                                                                                            | Track    | Core/Stretch | Stretch/Core Notes                                                  |
|:----:|----------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|:----------:|---------------------------------------------------------------------------------------------------------------------------------------|----------|:-------------:|------------------------------------------------------------------------|
| ex21 | Customer Cohort Revenue Growth                     | “Compare total revenue over time for each customer cohort (by first-purchase month).”                                                                      | CTEs, Window functions (`SUM OVER`, `ROWS BETWEEN`), date bucketing, joins                                              |     8      | **CUSTOMER → ORDERS → LINEITEM**                                                                           | Part 1   | Core         | Cohorting, date-bucketing, cumulative windows – essential pattern     |
| ex22 | Top 3 Parts by Revenue in Each Region              | “Find the highest-revenue parts in each region.”                                                                                                           | Multi-level window (`RANK()`), hierarchical joins, CTEs                                                                |     8      | **REGION → NATION → SUPPLIER → PARTSUPP → LINEITEM**                                                      | Part 1   | Core         | Advanced join traversal + partitioned ranking                         |
| ex23 | Month-over-Month Order Frequency Acceleration      | “Which customers more than doubled monthly order count?”                                                                                                   | Window `LAG()`, date bucketing, delta filter                                                                           |     7      | **CUSTOMER → ORDERS**                                                                                       | Part 1   | Core         | Growth detection using time-series diffs                             |
| ex24 | Rolling Avg Order Value by Segment                 | “6-month rolling AOV by market segment.”                                                                                                                   | Window frame (`ROWS BETWEEN …`), joins, `DATE_TRUNC`, grouping                                                         |     7      | **CUSTOMER → ORDERS → LINEITEM**                                                                           | Part 1   | Stretch      | Combines windowing + time bucketing                                  |
| ex25 | Supplier-Part Pricing Anomalies                    | “Detect suppliers charging abnormally high/low for a part.”                                                                                                | Statistical outlier detection (`STDDEV`, z-score), filtering                                                           |     9      | **PARTSUPP → PART → SUPPLIER → NATION**                                                                    | Part 1   | Stretch      | Statistical filtering over multi-table setup                         |

---

## Part 2

### Track 1: SQL Detective

#### Beginner

| Ex # | Title                                 | Business Question                                                                                           | SQL Concept                         | Difficulty | Dataset Familiarity Focus                                           | Track         | Core/Stretch | Stretch/Core Notes                                                  |
|:----:|---------------------------------------|-------------------------------------------------------------------------------------------------------------|-------------------------------------|:----------:|---------------------------------------------------------------------|---------------|:-------------:|------------------------------------------------------------------------|
| ex21 | Missing Customer Contacts             | “Which customers have no recorded contact info?”                                                           | `WHERE IS NULL`                     |     1      | **CUSTOMER** (C_PHONE, C_COMMENT)                                  | SQL Detective | Core         | NULL filtering introduction                                          |
| ex22 | Duplicate Customer Names              | “Which customers may be duplicates based on name?”                                                         | `GROUP BY` + `HAVING COUNT()>1`     |     2      | **CUSTOMER** (C_NAME, C_CUSTKEY)                                   | SQL Detective | Core         | Aggregation + anomaly detection                                     |
| ex23 | Orders with Negative Quantity         | “Which orders have negative or zero quantity items?”                                                       | `JOIN`, `WHERE L_QUANTITY<=0`       |     2      | **LINEITEM**, **ORDERS**                                           | SQL Detective | Core         | Practical multi-table anomaly scenario                              |
| ex24 | Outlier Discounts                     | “Identify discounts outside 0–50% range.”                                                                  | `WHERE` on numeric column           |     1      | **LINEITEM** (L_DISCOUNT)                                          | SQL Detective | Core         | Real-world numeric validation                                       |
| ex25 | Nations with No Suppliers             | “Which nations lack supplier coverage?”                                                                    | `LEFT JOIN` + `IS NULL`             |     3      | **NATION**, **SUPPLIER**                                           | SQL Detective | Core         | Anti-join logic; enables missing data use cases                     |
| ex26 | Suppliers Missing Comments            | “Which suppliers lack onboarding info?”                                                                    | `IS NULL`                           |     1      | **SUPPLIER**                                                       | SQL Detective | Stretch      | Variant of ex21                                                     |
| ex27 | Parts Never Sold                      | “Which parts have never appeared in line-item data?”                                                       | `LEFT JOIN` + `IS NULL`             |     3      | **PART**, **LINEITEM**                                             | SQL Detective | Stretch      | Extension of anti-join logic                                        |
| ex28 | Ship Date Before Order Date           | “Which shipments were booked before their order date?”                                                     | Join + `WHERE L_SHIPDATE < O_ORDERDATE` |     2      | **ORDERS**, **LINEITEM**                                           | SQL Detective | Stretch      | Date-comparison anomaly logic                                       |
| ex29 | Negative Account Balances             | “Which customers have negative account balances?”                                                          | `WHERE < 0`                         |     1      | **CUSTOMER** (C_ACCTBAL)                                           | SQL Detective | Stretch      | Basic numeric filter variation                                      |
| ex30 | Invalid Part Names                    | “Which part names contain invalid characters?”                                                             | `RLIKE` pattern match               |     3      | **PART** (P_NAME)                                                  | SQL Detective | Stretch      | Regex adds advanced string filtering                                |

#### Advanced

| Ex # | Title                                                  | Business Question                                                                                                                               | SQL Concept                                                                                  | Difficulty | Dataset Familiarity Focus                                                                                             | Track         | Core/Stretch | Stretch/Core Notes                                                                 |
|:----:|--------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------|:----------:|------------------------------------------------------------------------------------------------------------------------|---------------|:-------------:|--------------------------------------------------------------------------------------|
| ex31 | Dormant High-Balance Customers                         | “Which customers with high balances have very few orders?”                                                                                      | `JOIN` + `GROUP BY` + window `RANK()`                                                        |     5      | **CUSTOMER**, **ORDERS**, **LINEITEM**                                                                                 | SQL Detective | Core         | Combines join logic and window to detect anomalies                                |
| ex32 | Part Sizes Deviating from Modal                        | “Find parts that deviate from the most common size.”                                                                                            | CTE → `GROUP BY` + window `MAX()`                                                            |     5      | **PART**                                                                                                               | SQL Detective | Core         | CTE to identify mode + detect deviation                                            |
| ex33 | Excess Time Between Consecutive Orders                 | “Which customers have gaps >180 days between orders?”                                                                                           | `LAG()` + `DATEDIFF()`                                                                       |     5      | **ORDERS**                                                                                                             | SQL Detective | Core         | Lag and date functions to detect churn                                             |
| ex34 | Discount Outlier Detection via Z-Score                 | “Which line items have discounts > 2 std dev from average?”                                                                                     | subquery for avg/stddev → join → compute z-score                                             |     6      | **LINEITEM**                                                                                                           | SQL Detective | Core         | Statistical anomaly logic                                                          |
| ex35 | Supplier Cost Anomalies by Part                        | “Suppliers charging 20% above average for a part.”                                                                                              | CTE + `AVG()` + filter on `> avg * 1.2`                                                      |     6      | **PARTSUPP**, **PART**, **SUPPLIER**                                                                                  | SQL Detective | Core         | Benchmark supplier pricing using average                                           |
| ex36 | Order Revenue Mismatch                                 | “Orders where O_TOTALPRICE ≠ sum of discounted line items.”                                                                                     | `GROUP BY` → `SUM()` → compare to total                                                       |     5      | **ORDERS**, **LINEITEM**                                                                                               | SQL Detective | Stretch      | Multi-source validation pattern                                                    |
| ex37 | Cross-Region Shipments                                 | “Orders shipped to different country than customer’s home.”                                                                                     | multi-`JOIN` across customer + supplier + nation                                              |     6      | **CUSTOMER**, **ORDERS**, **LINEITEM**, **SUPPLIER**, **NATION**                                                      | SQL Detective | Stretch      | Complex mismatch detection                                                         |
| ex38 | Duplicate Part Names with Different Keys               | “Which part names occur under multiple part keys?”                                                                                              | `GROUP BY` + `HAVING COUNT(DISTINCT …) > 1`                                                  |     5      | **PART**                                                                                                               | SQL Detective | Stretch      | Simple but realistic data integrity case                                           |
| ex39 | Zero-Revenue Orders                                    | “Which orders generate zero revenue?”                                                                                                           | CTE to sum revenue per order → `WHERE revenue = 0`                                           |     5      | **ORDERS**, **LINEITEM**                                                                                               | SQL Detective | Stretch      | Detecting freebies or broken calculations                                          |
| ex40 | Orders with Abnormally High Item Counts                | “Which orders have line item counts more than twice average?”                                                                                   | Subquery to compute avg → outer filter                                                        |     5      | **LINEITEM**                                                                                                           | SQL Detective | Stretch      | Volume-based anomaly tracking                                                      |

---

### Track 2: Query Optimizer

#### Beginner

| Ex # | Title                                | Business Question                                                                                         | SQL Concept                                  | Difficulty | Dataset Familiarity Focus                                                           | Track            | Core/Stretch | Stretch/Core Notes                                                                 |
|:----:|--------------------------------------|-----------------------------------------------------------------------------------------------------------|----------------------------------------------|:----------:|-------------------------------------------------------------------------------------|------------------|:-------------:|-------------------------------------------------------------------------------------|
| ex41 | Segment-Filtered Customer List       | “Get only `C_NAME` and `C_ACCTBAL` for ‘AUTOMOBILE’ segment customers.”                                   | `SELECT` specific columns + `WHERE`          |     1      | **CUSTOMER**                                                                        | Query Optimizer  | Core         | Column projection + row filtering                                                  |
| ex42 | Limited Date Range Orders            | “Show order keys for Q1 1995 with `LIMIT 50`.”                                                             | `WHERE` on `O_ORDERDATE` + `LIMIT`           |     1      | **ORDERS**                                                                          | Query Optimizer  | Core         | Filter early and reduce data scanned                                               |
| ex43 | Small Join with Column Pruning       | “Get `O_ORDERKEY`, `C_NAME` only, for Q2 1995 orders.”                                                    | `JOIN` + column pruning                       |     2      | **ORDERS**, **CUSTOMER**                                                            | Query Optimizer  | Core         | Join with minimal payload                                                          |
| ex44 | Sample Five Line Items               | “Preview any 5 line items.”                                                                               | `SELECT` + `LIMIT 5`                          |     1      | **LINEITEM**                                                                        | Query Optimizer  | Core         | Quick inspection using limited projection                                          |
| ex45 | Filter Parts by Size                 | “Show part names where `P_SIZE = 15`.”                                                                    | `WHERE` equality                             |     1      | **PART**                                                                            | Query Optimizer  | Stretch      | Index-friendly equality filter                                                     |
| ex46 | Nation-Scoped Supplier List          | “List `S_SUPPKEY`, `S_NAME` for ‘SAUDI ARABIA’ suppliers.”                                                | `JOIN NATION → SUPPLIER` + `WHERE`           |     2      | **SUPPLIER**, **NATION**                                                            | Query Optimizer  | Stretch      | Filter after join                                                                  |
| ex47 | Aggregated Customer Count by Segment | “How many customers per market segment (only show if count > 100)?”                                       | `GROUP BY` + `HAVING`                         |     3      | **CUSTOMER**                                                                        | Query Optimizer  | Stretch      | Filtering after aggregation                                                        |
| ex48 | Distinct Supplier Regions            | “Get unique supplier nation names.”                                                                      | `DISTINCT` + `JOIN`                           |     3      | **SUPPLIER**, **NATION**                                                            | Query Optimizer  | Stretch      | De-duping to get summary metadata                                                  |
| ex49 | Early Date Filter in Join            | “Filter orders after 1996 before joining to LINEITEM.”                                                    | pre-filtering to reduce join cardinality     |     3      | **ORDERS**, **LINEITEM**                                                            | Query Optimizer  | Stretch      | Optimizes by pushing filter early                                                  |
| ex50 | Top 10 High-Value Line Items         | “Get top 10 `L_ORDERKEY`, `L_EXTENDEDPRICE`.”                                                             | `ORDER BY DESC` + `LIMIT`                     |     2      | **LINEITEM**                                                                        | Query Optimizer  | Stretch      | Small, efficient selection with sort + limit                                       |

---

#### Advanced

| Ex # | Title                                           | Business Question                                                                                                  | SQL Concept                                      | Difficulty | Dataset Familiarity Focus                                                                | Track            | Core/Stretch | Stretch/Core Notes                                                                      |
|:----:|-------------------------------------------------|--------------------------------------------------------------------------------------------------------------------|--------------------------------------------------|:----------:|------------------------------------------------------------------------------------------|------------------|:-------------:|------------------------------------------------------------------------------------------|
| ex51 | Early Filtering in CTE                          | “Filter orders in a CTE before joining for total revenue per order.”                                               | CTE + filter pushdown                            |     4      | **ORDERS**, **LINEITEM**                                                                | Query Optimizer  | Core         | Materialize a subset early                                                              |
| ex52 | SELECT vs SELECT * Performance                  | “Compare performance of `SELECT *` vs selected columns on large joins.”                                            | projection control                               |     4      | **ORDERS**, **LINEITEM**                                                                | Query Optimizer  | Core         | Teaches column-pruning performance gain                                                 |
| ex53 | Join Order Optimization                         | “Optimize join order: filter CUSTOMER → join to ORDERS → join to LINEITEM.”                                        | reordered `JOIN`s                                |     5      | **CUSTOMER**, **ORDERS**, **LINEITEM**                                                  | Query Optimizer  | Core         | Use of small filtered sets early                                                        |
| ex54 | QUALIFY for Highest-Revenue Line Item per Order | “Find top line item per order without subquery.”                                                                   | window `ROW_NUMBER()` + `QUALIFY`                |     5      | **LINEITEM**                                                                            | Query Optimizer  | Core         | Efficient alternative to nested filtering                                               |
| ex55 | Materialized Revenue Filter                     | “First compute order revenue, then filter for >$10,000 before final join.”                                         | Aggregation in CTE → filter                      |     4      | **ORDERS**, **LINEITEM**                                                                | Query Optimizer  | Stretch      | Avoid redundant aggregation                                                             |
| ex56 | Replace Correlated Subquery with Join           | “Count line items per order using GROUP BY rather than correlated subquery.”                                      | Subquery vs join strategy                        |     5      | **LINEITEM**, **ORDERS**                                                                | Query Optimizer  | Stretch      | Performance-minded query restructuring                                                  |
| ex57 | LIMIT Push-Down with ORDER BY                   | “Get top 5 orders by revenue using aggregation + LIMIT.”                                                           | Aggregate → `ORDER BY` → `LIMIT`                 |     5      | **ORDERS**, **LINEITEM**                                                                | Query Optimizer  | Stretch      | Efficient top-N pattern                                                                |
| ex58 | Filter Before Window                            | “Find top 3 discounted items per order, but only for orders after 1996.”                                           | Filter → window → `QUALIFY`                      |     6      | **ORDERS**, **LINEITEM**                                                                | Query Optimizer  | Stretch      | Partition trimming                                                                      |
| ex59 | Aggregate with Conditional CASE Logic           | “Compute total orders and revenue in one pass using conditional logic.”                                            | `SUM(CASE WHEN …)` + `COUNT()`                   |     5      | **CUSTOMER**, **ORDERS**, **LINEITEM**                                                  | Query Optimizer  | Stretch      | Efficient computation with conditional aggregation                                     |
| ex60 | Avoid SELECT DISTINCT via GROUP BY              | “Use `GROUP BY` instead of `DISTINCT` to get segment counts.”                                                      | `GROUP BY` vs `DISTINCT`                         |     4      | **CUSTOMER**                                                                            | Query Optimizer  | Stretch      | Encourages deduplication with intent                                                   |
| ex61 | Conceptual Explain Plan                         | “Review execution plan for large join between ORDERS and LINEITEM.”                                                | `EXPLAIN` plan inspection                        |     4      | **ORDERS**, **LINEITEM**                                                                | Query Optimizer  | Stretch      | Meta-level performance discussion                                                      |


### Track 3: Business Strategist

#### Beginner

| Ex # | Title                            | Business Question                                                                                     | SQL Concept                                                                                       | Difficulty | Dataset Familiarity Focus                                      | Track              | Core/Stretch | Stretch/Core Notes                                                      |
|:----:|----------------------------------|-------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------|:----------:|--------------------------------------------------------------|--------------------|:-------------:|---------------------------------------------------------------------------|
| ex62 | Total Revenue per Customer       | “Which customers generated the highest total revenue?”                                               | `JOIN` + `GROUP BY` + `SUM(L_EXTENDEDPRICE*(1-L_DISCOUNT))`                                      |     2      | **CUSTOMER**, **ORDERS**, **LINEITEM**                        | Business Strategist | Core         | Revenue by customer, classic metric                                    |
| ex63 | Monthly Sales Trend by Segment   | “How did each segment perform per month in 1996?”                                                    | `JOIN`, `DATE_TRUNC`, `GROUP BY`                                                                  |     3      | **CUSTOMER**, **ORDERS**, **LINEITEM**                        | Business Strategist | Core         | Adds time bucketing                                                    |
| ex64 | Avg Order Value by Customer      | “Who consistently places high-value orders?”                                                         | Subquery or CTE: order → average per customer                                                    |     3      | **CUSTOMER**, **ORDERS**, **LINEITEM**                        | Business Strategist | Core         | Supports LTV/quality analysis                                          |
| ex65 | Customer Count by Segment        | “How many customers exist per segment?”                                                              | `GROUP BY` + `COUNT(*)`                                                                           |     2      | **CUSTOMER**                                                | Business Strategist | Core         | Simple segment sizing                                                  |
| ex66 | Top 5 Parts by Revenue in 1995   | “Guide inventory by listing top 5 parts in 1995.”                                                    | `JOIN` + `GROUP BY` + `ORDER BY` + `LIMIT`                                                       |     3      | **PART**, **ORDERS**, **LINEITEM**                          | Business Strategist | Stretch      | Classic top-N pattern                                                  |
| ex67 | Revenue by Region                | “Which regions drive the most sales?”                                                                | Multi-table `JOIN`, `GROUP BY`                                                                    |     4      | **REGION**, **NATION**, **SUPPLIER**, **PARTSUPP**, **LINEITEM** | Business Strategist | Stretch      | Geographic aggregation                                                 |
| ex68 | Year-over-Year Growth            | “Compare Q1 1995 vs Q1 1996 revenue to assess YoY growth.”                                           | Two filtered `SUM()`s with `CASE` or subqueries                                                  |     4      | **ORDERS**, **LINEITEM**                                  | Business Strategist | Stretch      | Requires date filtering, logic branching                              |
| ex69 | First Purchase Cohorts           | “Group customers by first purchase month.”                                                           | Subquery: `MIN(O_ORDERDATE)` → `DATE_TRUNC` → `GROUP BY`                                         |     3      | **CUSTOMER**, **ORDERS**                                    | Business Strategist | Stretch      | Cohorting with date logic                                             |
| ex70 | Repeat Purchase Rate             | “What % of customers ordered more than once?”                                                        | Subquery: count orders per customer → filter → ratio                                             |     4      | **CUSTOMER**, **ORDERS**                                    | Business Strategist | Stretch      | Builds cohort/loyalty metric                                          |
| ex71 | Revenue Share by Segment         | “Calculate each segment’s share of total revenue.”                                                   | Join + `GROUP BY` + `SUM()` + subquery or window to get total                                    |     4      | **CUSTOMER**, **ORDERS**, **LINEITEM**                      | Business Strategist | Stretch      | Relational % of total pattern                                         |

---

#### Advanced

| Ex # | Title                                           | Business Question                                                                                               | SQL Concept                                                                                                           | Difficulty | Dataset Familiarity Focus                                      | Track              | Core/Stretch | Stretch/Core Notes                                                       |
|:----:|-------------------------------------------------|-------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------|:----------:|--------------------------------------------------------------|--------------------|:-------------:|----------------------------------------------------------------------------|
| ex72 | Customer Cohort Revenue Over Time               | “Chart cumulative revenue per customer cohort over 12 months.”                                                  | CTE for cohort + window `SUM()` with frame                                                                            |     6      | **CUSTOMER**, **ORDERS**, **LINEITEM**                        | Business Strategist | Core         | Builds on cohort logic in a time-series view                              |
| ex73 | Top 3 Parts by Revenue per Region               | “Identify the top 3 parts per region for procurement planning.”                                                 | Multi-level `JOIN`, `RANK() OVER (PARTITION BY …)`                                                                  |     7      | **LINEITEM**, **SUPPLIER**, **NATION**, **REGION**, **PART** | Business Strategist | Core         | Geographic + product-level ranking                                        |
| ex74 | MoM Revenue Growth per Segment                  | “Spot fast-growing segments by checking 10%+ revenue growth.”                                                   | `DATE_TRUNC`, `LAG()`, ratio filter                                                                                   |     6      | **CUSTOMER**, **ORDERS**, **LINEITEM**                      | Business Strategist | Core         | Trend monitoring logic                                                    |
| ex75 | Rolling 6-Month Avg Order Value                 | “Smooth AOV over time by segment with 6-month rolling average.”                                                 | Window `AVG()` + `ROWS BETWEEN 5 PRECEDING` + joins                                                                  |     6      | **CUSTOMER**, **ORDERS**, **LINEITEM**                      | Business Strategist | Core         | Moving average logic                                                      |
| ex76 | High-Value Seasonal Segments                    | “Which segments see Q4 AOV > 20% above annual average?”                                                         | CTE: Q4 + annual AOV → join and compare                                                                              |     6      | **CUSTOMER**, **ORDERS**, **LINEITEM**                      | Business Strategist | Stretch      | Group + compare aggregates over time periods                             |
| ex77 | Cohort Churn Rate                               | “What % of cohort stopped ordering after 3 months?”                                                             | CTEs for cohort + follow-up orders + `COUNT(DISTINCT)` + division                                                   |     5      | **CUSTOMER**, **ORDERS**                                    | Business Strategist | Stretch      | Retention/churn tracking                                                  |
| ex78 | Rolling 12-Month Revenue Trend per Brand        | “Track brand-level revenue trends using rolling 12-month totals.”                                               | `SUBSTR()`, `SUM() OVER` with wide frame                                                                            |     6      | **PART**, **LINEITEM**, **ORDERS**                          | Business Strategist | Stretch      | Combines string transformation with time logic                          |
| ex79 | Year-over-Year Market Share by Segment          | “Which segment gained the most market share from 1995 to 1996?”                                                 | Two CTEs → join → compute deltas → `RANK()`                                                                          |     7      | **CUSTOMER**, **ORDERS**, **LINEITEM**                      | Business Strategist | Stretch      | Comparative share tracking                                                |
| ex80 | LTV Comparison Early vs. Late Cohorts           | “Compare average 12-month LTV of early (Q1 1995) vs late (Q1 1996) customers.”                                   | CTE for cohorts → window `SUM()` → filter by date → `AVG()`                                                         |     7      | **CUSTOMER**, **ORDERS**, **LINEITEM**                      | Business Strategist | Stretch      | Layered filtering over cohort-based framing                              |
| ex81 | Detect Declining Part Demand                    | “Which parts saw revenue drop > 30% between rolling 6-month periods?”                                           | Compare two windows → filter on percent drop                                                                        |     7      | **PART**, **LINEITEM**, **ORDERS**                          | Business Strategist | Stretch      | Comparison of rolling windows                                             |
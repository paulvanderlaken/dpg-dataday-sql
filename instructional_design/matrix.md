# Instructional Design Matrices

## Part 1

### Beginner

| Ex # | Title                                | Business Question                                                                                  | SQL Concept                      | Difficulty | Dataset Familiarity Focus                                |
| :--: | ------------------------------------ | -------------------------------------------------------------------------------------------------- | -------------------------------- | :--------: | -------------------------------------------------------- |
| ex01 | Top 10 Customers by Balance          | “Which customers should we prioritize for a high-value loyalty program based on account balances?” | `SELECT` + `ORDER BY` + `LIMIT`  |     2      | **CUSTOMER**: C_CUSTKEY, C_NAME, C_ACCTBAL                |
| ex02 | Filter Customers by Market Segment   | “Which clients operate in the BUILDING segment so we can tailor our next campaign?”                | `WHERE` (equality)               |     1      | **CUSTOMER**: C_MKTSEG                                   |
| ex03 | Orders in Q1 1995                    | “What was order activity in Q1 1995 to audit seasonal demand trends?”                              | `WHERE` (date filter, `BETWEEN`) |     2      | **ORDERS**: O_ORDERDATE, O_ORDERKEY, O_CUSTKEY           |
| ex04 | Project Part Attributes              | “What are the key attributes (ID, name, size) of our current parts catalog for the product deck?”  | Column projection                |     1      | **PART**: P_PARTKEY, P_NAME, P_SIZE                      |
| ex05 | High-Quantity or Low-Price Lineitems | “Which line items qualify for bulk discounts or low-price promotions?”                             | `WHERE` with `AND/OR`            |     2      | **LINEITEM**: L_QUANTITY, L_EXTENDEDPRICE, L_DISCOUNT    |
| ex06 | Sample Five Parts                    | “Show me any five parts (no particular order) as a quick sanity check when exploring the catalog. How does this differ from selecting a top subset with ORDER BY LIMIT?” | `LIMIT`                          |     1      | **PART**: quick sampling of P_PARTKEY, P_NAME            |
| ex07 | Sort Parts by Size and Name          | “List parts sorted first by size then alphabetically—so our UI can group and label them.”          | `ORDER BY` multiple columns      |     2      | **PART**: P_SIZE, P_NAME                                 |
| ex08 | Nations Starting with “U”            | “Which countries begin with ‘U’ for our regional mapping prototype?”                               | `LIKE` (pattern matching)        |     2      | **NATION**: N_NAME, N_NATIONKEY                          |
| ex09 | Suppliers with Missing Comments      | “Identify suppliers lacking commentary to flag data-quality issues in our onboarding process.”     | `IS NULL` / `IS NOT NULL`        |     1      | **SUPPLIER**: S_SUPPKEY, S_NAME, S_COMMENT                |
| ex10 | Compute Price + Tax                  | “What would each line item cost including a 5% tax for invoice previews?”                          | Arithmetic in `SELECT`           |     2      | **LINEITEM**: L_EXTENDEDPRICE, basic math expr            |

### Advanced

| Ex # | Title                                  | Business Question                                                                                      | SQL Concept                           | Difficulty | Dataset Familiarity Focus                                             |
| :--: | -------------------------------------- | ------------------------------------------------------------------------------------------------------ | ------------------------------------- | :--------: | --------------------------------------------------------------------- |
| ex11 | Total Sales per Part                   | “Which parts generated the most revenue last month to inform our restocking priorities?”               | `GROUP BY` + `SUM`                    |     3      | **LINEITEM** → P_PARTKEY aggregation                                  |
| ex12 | Parts with Sales ≥ X                   | “Which parts sold at least 1,000 units so we can negotiate bulk pricing?”                              | `HAVING` on aggregates                |     4      | **LINEITEM** + filter on aggregated L_QUANTITY                        |
| ex13 | Join Orders to Customers               | “Show customer details alongside their orders to prepare a consolidated customer-order report.”        | `INNER JOIN`                          |     3      | **ORDERS** ↔ **CUSTOMER** (O_CUSTKEY → C_CUSTKEY)                      |
| ex14 | Lineitems ↔ Orders ↔ Parts Cascade     | “Combine line items, orders, and part info to build a full order-detail feed for BI ingestion.”        | Multi-table `JOIN`                    |     4      | **LINEITEM**, **ORDERS**, **PART**                                     |
| ex15 | Supplier Part List via CTE             | “Generate a cleaned supplier-part list to feed into our vendor management dashboard.”                  | `WITH` / CTE                          |     5      | **PARTSUPP** joined to **PART** & **SUPPLIER**                         |
| ex16 | Nation Name in SELECT via Subquery     | “Retrieve each region’s name alongside its country count without an explicit join in the SELECT list.” | Scalar subquery in `SELECT`           |     5      | **REGION** → **NATION** lookup (nested)                                |
| ex17 | Rank Orders by Date                    | “Assign a sequential rank to orders by date so we can highlight the very first order per customer.”    | Window function `ROW_NUMBER() OVER()` |     6      | **ORDERS**: time ordering, window framing                              |
| ex18 | Top 5 Discounts per Order              | “Which five line items received the steepest discounts in each order for a promotional analysis?”      | Window function `RANK() OVER()`       |     6      | **LINEITEM**: partition by L_ORDERKEY, ranking by L_DISCOUNT         |
| ex19 | Customers with Their Latest Order Date | “Find each customer’s most recent order date to power an ‘activity recency’ metric in our CRM.”        | Derived table (subquery in `FROM`)    |     5      | **CUSTOMER** joined to max O_ORDERDATE in **ORDERS**                  |
| ex20 | Rolling Sum of Sales per Day           | “Show daily cumulative sales so we can monitor revenue build-up intra-month in our live dashboard.”    | `SUM() OVER (ORDER BY)` window agg    |     6      | **LINEITEM** + date sequence from O_ORDERDATE via join to **ORDERS**  |

### Expert

| Ex # | Title                                                 | Business Question                                                                                                                                        | SQL Concepts & Techniques                                                                                               | Difficulty | Dataset Familiarity Focus                                                                                                                                            |
| :--: | ----------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------- | :--------: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| ex21 | Customer Cohort Revenue Growth                        | “Compare total revenue over time for each customer cohort (by first-purchase month) so we can measure cohort retention and LTV curves.”                  | CTEs, Window functions (e.g. `SUM() OVER (PARTITION BY … ORDER BY … ROWS BETWEEN…)`), date bucketing, joins             |     8      | **CUSTOMER → ORDERS → LINEITEM**: cohort definition by `O_ORDERDATE`; cumulative revenue per cohort                                                                   |
| ex22 | Top 3 Parts by Revenue in Each Region                 | “Identify the three highest-revenue parts in each geographic region to tailor regional inventory strategies.”                                            | Multi-level window (`RANK()`), hierarchical joins, CTEs/subqueries                                                      |     8      | **REGION → NATION → SUPPLIER → PARTSUPP → LINEITEM**: traverse geography → supplier relationships → revenue aggregation                                               |
| ex23 | Month-over-Month Order Frequency Acceleration         | “Which customers more than doubled their monthly order count, signaling rapidly growing accounts that warrant special outreach?”                         | Window diff (`LAG()`), derived tables, filtering on computed deltas                                                     |     7      | **CUSTOMER → ORDERS**: compute order counts monthly per customer, compare current vs. prior month to find ≥100% growth                                                |
| ex24 | Rolling 6-Month Average Order Value by Market Segment | “Calculate the six-month rolling average order value by market segment to spot shifts in segment purchasing behavior over time.”                         | Window frame (`ROWS BETWEEN 5 PRECEDING`), joins, `DATE_TRUNC`, grouping                                                |     7      | **CUSTOMER → ORDERS → LINEITEM**: join to get line-item totals, date-truncate to month, then 6-month rolling average per `C_MKTSEG`                                   |
| ex25 | Detect Supplier-Part Pricing Anomalies                | “Flag suppliers whose quoted cost for a given part is unusually high or low compared to peer averages, to negotiate better terms or investigate errors.” | JOINs across supply-chain tables, statistical functions (e.g. `STDDEV()`), filtering outliers via z-score or thresholds |     9      | **PARTSUPP → PART → SUPPLIER → NATION**: compare each supplier’s `PS_SUPPLYCOST` vs. overall part cost distribution to flag anomalous supply costs relative to peers        |

---

## Part 2

### Track 1: SQL Detective

#### Beginner

| Ex # | Title                                 | Business Question                                                                                           | SQL Concept                                                 | Difficulty | Dataset Familiarity Focus                                           |
| :--: | ------------------------------------- | ----------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------- | :--------: | ------------------------------------------------------------------- |
| ex26 | Missing Customer Contacts             | “Which customers have no recorded contact information so we can flag their profiles for data enrichment?”   | `SELECT` … `WHERE IS NULL`                                  |     1      | **CUSTOMER** (C_PHONE, C_COMMENT)                                  |
| ex27 | Duplicate Customer Names              | “Are there customers sharing the same name (possible duplicates) that we need to investigate?”              | `GROUP BY` … `HAVING COUNT()>1`                             |     2      | **CUSTOMER** (C_NAME, C_CUSTKEY)                                   |
| ex28 | Orders with Zero or Negative Quantity | “Which orders contain line items with zero or negative quantities, indicating potential data‐entry errors?” | `JOIN`, `WHERE L_QUANTITY<=0`                               |     2      | **LINEITEM** (L_ORDERKEY, L_QUANTITY) + **ORDERS** (O_ORDERKEY)     |
| ex29 | Outlier Discounts                     | “Identify line items with discount values outside the normal range (e.g., < 0 or > 0.5) that may be typos.” | `WHERE` on numeric columns                                  |     1      | **LINEITEM** (L_DISCOUNT, L_ORDERKEY, L_PARTKEY)                  |
| ex30 | Suppliers Missing Comments            | “Which suppliers lack comments in their profiles, potentially signaling incomplete onboarding?”             | `WHERE S_COMMENT IS NULL`                                   |     1      | **SUPPLIER** (S_SUPPKEY, S_NAME, S_COMMENT)                       |
| ex31 | Nations with No Suppliers             | “Which nations currently have no associated suppliers, indicating possible coverage gaps?”                  | `LEFT JOIN` … `WHERE supplier IS NULL`                      |     3      | **NATION** (N_NATIONKEY, N_NAME) + **SUPPLIER** (S_NATIONKEY)    |
| ex32 | Parts Never Sold                      | “Which parts have zero line-item records, suggesting they’ve never been sold?”                              | `LEFT JOIN` PART → LINEITEM … `WHERE lineitem IS NULL`      |     3      | **PART** (P_PARTKEY, P_NAME) + **LINEITEM** (L_PARTKEY)          |
| ex33 | Inconsistent Ship vs. Order Dates     | “Spot line items where ship date precedes order date, signaling possible data inconsistencies.”             | `JOIN` ORDERS + LINEITEM … `WHERE L_SHIPDATE < O_ORDERDATE` |     2      | **ORDERS** (O_ORDERKEY, O_ORDERDATE) + **LINEITEM** (L_SHIPDATE) |
| ex34 | Negative Account Balances             | “Which customers currently have a negative account balance that may indicate billing issues?”               | `WHERE C_ACCTBAL < 0`                                       |     1      | **CUSTOMER** (C_CUSTKEY, C_NAME, C_ACCTBAL)                       |
| ex35 | Invalid Part Names                    | “Which parts have names containing non-alphanumeric characters that might break downstream scripts?”        | `WHERE P_NAME RLIKE '[^A-Za-z0-9 ]'`                        |     3      | **PART** (P_PARTKEY, P_NAME)                                      |

#### Advanced

| Ex # | Title                                                  | Business Question                                                                                                                               | SQL Concept                                                                                  | Difficulty | Dataset Familiarity Focus                                                                                                                                                                     |
| :--: | ------------------------------------------------------ | ----------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------- | :--------: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| ex36 | Customers with Unusually Low Orders Given High Balance | “Which customers with high account balances have contributed very few orders, potentially indicating dormant high-value accounts?”              | `JOIN` + `GROUP BY` + `SUM()` + window `RANK()`                                              |     5      | **CUSTOMER** → **ORDERS** (O_CUSTKEY, O_ORDERKEY) + **LINEITEM** (L_EXTENDEDPRICE)                                                                                                          |
| ex37 | Part Sizes Deviating from Modal                        | “Find part sizes that deviate from the most common size category to flag potential misclassifications in our catalog.”                          | CTE → `GROUP BY` size, count → window `MAX()` over CTE                                       |     5      | **PART** (P_PARTKEY, P_SIZE)                                                                                                                                                                 |
| ex38 | Excess Time Between Consecutive Orders                 | “Which customers have gaps longer than 180 days between consecutive orders, hinting at churn or seasonal patterns?”                             | window `LAG()` + `DATEDIFF()` + filtering after window                                       |     5      | **ORDERS** (O_CUSTKEY, O_ORDERKEY, O_ORDERDATE)                                                                                                                                             |
| ex39 | Discount Outlier Detection via Z-Score                 | “Flag line items whose discount deviates more than 2 standard deviations from the average discount (anomaly hunt).”                             | subquery for avg & stddev → join → compute z-score                                           |     6      | **LINEITEM** (L_ORDERKEY, L_DISCOUNT)                                                                                                                                                        |
| ex40 | Supplier Cost Anomalies by Part                        | “Identify suppliers whose supply cost for a part is more than 20% above the part’s average supply cost, pinpointing negotiation opportunities.” | CTEs + `AVG()`/`STDDEV()` + `WHERE cost > avg * 1.2`                                         |     6      | **PARTSUPP** (PS_PARTKEY, PS_SUPPKEY, PS_SUPPLYCOST) + **PART** (P_PARTKEY) + **SUPPLIER** (S_SUPPKEY)                                                                                     |
| ex41 | Order Revenue Mismatch                                 | “Which orders have a stored `O_TOTALPRICE` that doesn’t match the sum of their line items’ extended prices (accounting for discounts)?”         | `GROUP BY` order → compute `SUM(L_EXTENDEDPRICE*(1-L_DISCOUNT))` → compare to `O_TOTALPRICE` |     5      | **ORDERS** (O_ORDERKEY, O_TOTALPRICE) + **LINEITEM** (L_ORDERKEY, L_EXTENDEDPRICE, L_DISCOUNT)                                                                                            |
| ex42 | Cross-Region Shipments                                 | “Find any orders shipped to a nation different from the customer’s home nation, indicating possible data misrouting.”                           | multi-table `JOIN` (ORDER→CUSTOMER→NATION vs. LINEITEM→SUPPLIER→NATION) + `WHERE mismatched` |     6      | **ORDERS** (O_ORDERKEY, O_CUSTKEY) + **CUSTOMER** (C_CUSTKEY, C_NATIONKEY) + **LINEITEM** (L_ORDERKEY, L_SUPPKEY) + **SUPPLIER** (S_SUPPKEY, S_NATIONKEY) + **NATION** (N_NATIONKEY) |
| ex43 | Duplicate Part Names with Different Keys               | “Which part names appear more than once but with different `P_PARTKEY` values, suggesting catalog duplication?”                                 | `GROUP BY P_NAME` → `HAVING COUNT(DISTINCT P_PARTKEY) > 1`                                   |     5      | **PART** (P_PARTKEY, P_NAME)                                                                                                                                                                |
| ex44 | Zero-Revenue Orders                                    | “Which orders yield zero revenue (all line items have zero extended price after discount), indicating possible free-sample orders?”             | CTE to sum revenue per order → `WHERE total_revenue = 0`                                     |     5      | **LINEITEM** (L_ORDERKEY, L_EXTENDEDPRICE, L_DISCOUNT) + **ORDERS** (O_ORDERKEY)                                                                                                           |
| ex45 | Orders with Abnormally High Item Counts                | “Identify orders containing more than twice the average number of line items, highlighting potential bulk orders or data anomalies.”            | subquery to compute avg count per order; then filter orders with `COUNT > avg * 2`           |     5      | **LINEITEM** (L_ORDERKEY)                                                                                                                                                                   |

---

### Track 2: Query Optimizer

#### Beginner

| Ex # | Title                                | Business Question                                                                                                                   | SQL Concept                                  | Difficulty | Dataset Familiarity Focus                                                               |
| :--: | ------------------------------------ | ----------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------- | :--------: | --------------------------------------------------------------------------------------- |
| ex46 | Segment-Filtered Customer List       | “Retrieve only `C_NAME` and `C_ACCTBAL` for ‘AUTOMOBILE’ segment customers to minimize scanned columns and data volume.”            | `SELECT` specific columns + `WHERE`          |     1      | **CUSTOMER** (C_NAME, C_ACCTBAL, C_MKTSEG)                                               |
| ex47 | Limited Date Range Orders            | “Show order keys for orders placed between 1995-01-01 and 1995-03-31 with `LIMIT 50`, reducing runtime.”                            | `WHERE` on `O_ORDERDATE` + `LIMIT`           |     1      | **ORDERS** (O_ORDERDATE, O_ORDERKEY)                                                    |
| ex48 | Small Join with Column Pruning       | “List `O_ORDERKEY` and `C_NAME` for orders in Q2 1995 by joining to CUSTOMER but only selecting needed fields.”                     | `JOIN` + column projection                   |     2      | **ORDERS** (O_ORDERKEY, O_ORDERDATE, O_CUSTKEY) + **CUSTOMER** (C_CUSTKEY, C_NAME)      |
| ex49 | Sample Five Line Items               | “Retrieve any five `L_ORDERKEY`, `L_PARTKEY`, `L_EXTENDEDPRICE` rows to quickly inspect sample data.”                               | `SELECT` + `LIMIT 5`                         |     1      | **LINEITEM** (L_ORDERKEY, L_PARTKEY, L_EXTENDEDPRICE)                                  |
| ex50 | Filter Parts by Size                 | “Show part keys and names for parts where `P_SIZE = 15`, avoiding scanning other sizes.”                                            | `WHERE P_SIZE = 15`                          |     1      | **PART** (P_PARTKEY, P_NAME, P_SIZE)                                                   |
| ex51 | Nation-Scoped Supplier List          | “List `S_SUPPKEY` and `S_NAME` for suppliers in the ‘SAUDI ARABIA’ nation to reduce unnecessary rows.”                              | `JOIN NATION → SUPPLIER` + `WHERE`           |     2      | **NATION** (N_NAME) + **SUPPLIER** (S_SUPPKEY, S_NAME, S_NATIONKEY)                    |
| ex52 | Aggregated Customer Count by Segment | “Count the number of customers in each `C_MKTSEG`, but only show rows where count > 100—pruning early.”                             | `GROUP BY C_MKTSEG` + `HAVING`               |     3      | **CUSTOMER** (C_MKTSEG)                                                                 |
| ex53 | Distinct Supplier Regions            | “Get distinct nation names of all suppliers to quickly summarize geographic spread.”                                                | `DISTINCT` + `JOIN`                          |     3      | **SUPPLIER** (S_SUPPKEY, S_NATIONKEY) + **NATION** (N_NATIONKEY, N_NAME)               |
| ex54 | Joined Orders with Early Date Filter | “Join ORDERS→LINEITEM but filter `O_ORDERDATE > 1996-01-01` first to reduce join size.”                                             | filter on ORDERS before join                 |     3      | **ORDERS** (O_ORDERDATE, O_ORDERKEY) + **LINEITEM** (L_ORDERKEY)                      |
| ex55 | Top 10 High-Value Line Items         | “Select only `L_ORDERKEY` and `L_EXTENDEDPRICE` for the ten most expensive line items, minimizing data volume in ORDER BY + LIMIT.” | `ORDER BY L_EXTENDEDPRICE DESC` + `LIMIT 10` |     2      | **LINEITEM** (L_ORDERKEY, L_EXTENDEDPRICE)                                             |

#### Advanced

| Ex # | Title                                                 | Business Question                                                                                                                                                       | SQL Concept                                          | Difficulty | Dataset Familiarity Focus                                                                                         |
| :--: | ----------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------- | :--------: | ----------------------------------------------------------------------------------------------------------------- |
| ex56 | Early Filtering in CTE                                | “Rewrite a multi-join query to filter `ORDERS` by date in a CTE first, reducing join cardinality when computing total revenue per order.”                               | CTE + push‐down `WHERE`                              |     4      | **ORDERS** (O_ORDERDATE, O_ORDERKEY, O_TOTALPRICE) + **LINEITEM** (L_ORDERKEY, L_EXTENDEDPRICE, L_DISCOUNT)       |
| ex57 | Column vs. SELECT * Comparison                       | “Compare performance between `SELECT *` and `SELECT`-specific-columns for a large join (ORDERS→LINEITEM), showing the cost difference.”                                 | SELECT specific columns vs. `*`                      |     4      | **ORDERS**, **LINEITEM**                                                                                          |
| ex58 | Join Order Optimization                               | “Optimize a three-table join (CUSTOMER→ORDERS→LINEITEM) by filtering smallest table first (e.g., customers in ‘BUILDING’ segment) then joining to reduce overall cost.” | join ordering + filtered subqueries or CTE           |     5      | **CUSTOMER**, **ORDERS**, **LINEITEM**                                                                            |
| ex59 | QUALIFY to Limit Window Results                       | “Retrieve the single highest-revenue line item per order using a window function with `QUALIFY`, avoiding an extra nested subquery.”                                    | window `ROW_NUMBER()` + `QUALIFY`                    |     5      | **LINEITEM** (L_ORDERKEY, L_EXTENDEDPRICE, L_DISCOUNT)                                                         |
| ex60 | Materialize Intermediate Results with CTE             | “Use a CTE to compute revenue per order first, then join to ORDERS to list only orders above $10,000—preventing repeated aggregation.”                                 | CTE → aggregated subquery + join                     |     4      | **LINEITEM**, **ORDERS**                                                                                          |
| ex61 | Eliminate Correlated Subquery in Join                 | “Refactor a correlated subquery that counts line items per order into a join + aggregated grouping for faster execution.”                                               | replace correlated subquery with `JOIN` + `GROUP BY` |     5      | **LINEITEM** (L_ORDERKEY) + **ORDERS** (O_ORDERKEY)                                                             |
| ex62 | LIMIT Push-Down with ORDER BY Avoiding Full Sort      | “Fetch the top 5 orders by total revenue without sorting the entire set—apply `LIMIT 5` after computing partial aggregates in a subquery.”                              | subquery aggregation → `ORDER BY` + `LIMIT`          |     5      | **LINEITEM**, **ORDERS**                                                                                          |
| ex63 | Window Function after Filter to Reduce Partition Size | “Find the top 3 most-discounted line items per order, but first filter out orders before 1996 to shrink the window partitions.”                                         | `WHERE` date filter → window `RANK()` + `QUALIFY`    |     6      | **ORDERS**, **LINEITEM**                                                                                          |
| ex64 | Compute Aggregates in Single Pass                     | “Write a query to list each customer’s total orders and total revenue in one scan using conditional aggregation instead of two separate queries.”                       | `SUM(CASE WHEN … THEN … END)` + `COUNT(*)`           |     5      | **CUSTOMER**, **ORDERS**, **LINEITEM**                                                                            |
| ex65 | Avoid SELECT DISTINCT via GROUP BY and COUNT          | “Instead of `SELECT DISTINCT C_MKTSEG FROM CUSTOMER`, use `GROUP BY C_MKTSEG` with `COUNT(*)` to compute segment counts and reduce dedup overhead.”                     | `GROUP BY` + `COUNT()`                               |     4      | **CUSTOMER** (C_MKTSEG)                                                                                          |
| ex66 | Explain Plan Inspection (Conceptual)                  | “Review the execution plan for a large join between ORDERS and LINEITEM to identify bottlenecks and estimate cost reductions.”                                         | `EXPLAIN` plan interpretation; conceptual cost estimation |     4      | **ORDERS**, **LINEITEM**                                                                                          |

---

### Track 3: Business Strategist

#### Beginner

| Ex # | Title                            | Business Question                                                                                     | SQL Concept                                                                                                                                         | Difficulty | Dataset Familiarity Focus                                        |
| :--: | -------------------------------- | ----------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------- | :--------: | ---------------------------------------------------------------- |
| ex67 | Total Revenue per Customer       | “Which customers generated the highest total revenue, to prioritize top accounts for upselling?”      | `JOIN` + `GROUP BY` + `SUM(L_EXTENDEDPRICE*(1-L_DISCOUNT))`                                                                                         |     2      | **CUSTOMER**, **ORDERS**, **LINEITEM**                           |
| ex68 | Monthly Sales Trend by Segment   | “What were the total sales for each month of 1996 within each market segment to spot segment-specific seasonal demand?” | `JOIN` (to bring in C_MKTSEG) + `DATE_TRUNC('month', O_ORDERDATE)` + `GROUP BY C_MKTSEG, month`                                                        |     3      | **CUSTOMER**, **ORDERS**, **LINEITEM**                           |
| ex69 | Average Order Value by Customer  | “What is each customer’s average order value, to identify who consistently places high-value orders?” | subquery or CTE: revenue per order → `AVG()` per customer                                                                                            |     3      | **ORDERS**, **LINEITEM** + **CUSTOMER**                          |
| ex70 | Customer Count by Market Segment | “How many customers exist in each market segment, for segment-level targeting?”                       | `GROUP BY C_MKTSEG` + `COUNT(*)`                                                                                                                    |     2      | **CUSTOMER** (C_MKTSEG)                                         |
| ex71 | Top 5 Parts by Revenue           | “List the top 5 parts by total revenue in 1995 to guide inventory prioritization.”                    | `JOIN` LINEITEM→PART + `WHERE O_ORDERDATE BETWEEN …` + `GROUP BY P_NAME` + `ORDER BY SUM(L_EXTENDEDPRICE*(1-L_DISCOUNT)) DESC` + `LIMIT 5`          |     3      | **PART**, **LINEITEM**, **ORDERS**                               |
| ex72 | Revenue by Region                | “Compute total revenue per region to understand which geographies drive the most sales.”              | multi-table `JOIN`: LINEITEM→PARTSUPP→SUPPLIER→NATION→REGION + `GROUP BY R_NAME`                                                                      |     4      | **LINEITEM**, **PARTSUPP**, **SUPPLIER**, **NATION**, **REGION** |
| ex73 | Year-Over-Year Sales Growth      | “Compare Q1 1995 vs Q1 1996 total revenue to measure year-over-year growth.”                          | two filtered `SUM()` aggregates with `CASE WHEN` or separate subqueries                                                                              |     4      | **ORDERS**, **LINEITEM**                                         |
| ex74 | First Purchase Cohorts           | “Group customers by the month of their first order, and count how many joined in each cohort.”        | subquery/CTE: find `MIN(O_ORDERDATE)` per customer → `DATE_TRUNC('month', …)` → `GROUP BY`                                                            |     3      | **CUSTOMER**, **ORDERS**                                         |
| ex75 | Repeat Purchase Rate             | “What percentage of customers placed more than one order, indicating loyal repeat buyers?”            | subquery: count orders per customer → filter `>1` → divide by total customer count                                                                   |     4      | **ORDERS**, **CUSTOMER**                                         |
| ex76 | Revenue Share by Market Segment  | “Calculate each market segment’s share of total revenue to allocate marketing budget.”                | join + `GROUP BY C_MKTSEG` + `SUM()` + window function or subquery to compute total                                                                   |     4      | **CUSTOMER**, **ORDERS**, **LINEITEM**                           |

#### Advanced

| Ex # | Title                                             | Business Question                                                                                                                                               | SQL Concept                                                                                                                                                                              | Difficulty | Dataset Familiarity Focus                                                  |
| :--: | ------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :--------: | -------------------------------------------------------------------------- |
| ex77 | Customer Cohort Revenue Over Time                 | “Compute cumulative revenue per customer‐cohort (by first‐purchase month) to chart cohort retention and lifetime value over 12 months.”                         | CTE for cohort assignment → window `SUM(...) OVER (PARTITION BY cohort ORDER BY month ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)`                                                 |     6      | **CUSTOMER** → **ORDERS** → **LINEITEM**                                   |
| ex78 | Top 3 Parts by Revenue per Region                 | “Identify the top 3 revenue‐generating parts within each geographic region to tailor regional procurement strategies.”                                          | nested window `RANK() OVER (PARTITION BY region ORDER BY revenue DESC)`; multi-level joins (LINEITEM→PART→PARTSUPP→SUPPLIER→NATION→REGION)                                               |     7      | **LINEITEM**, **PART**, **PARTSUPP**, **SUPPLIER**, **NATION**, **REGION** |
| ex79 | Month-Over-Month Revenue Growth by Market Segment | “Which market segments saw revenue growth greater than 10% from month to month in 1996, highlighting rapidly expanding segments?”                               | date bucketing (`DATE_TRUNC('month', O_ORDERDATE)`), window `LAG(revenue)` for prior month, then filter `growth > 0.1`                                                                   |     6      | **CUSTOMER** (C_MKTSEG) → **ORDERS** → **LINEITEM**                       |
| ex80 | Six-Month Rolling Average Order Value per Segment | “Calculate the six-month rolling average order value (AOV) by market segment to smooth out fluctuations and detect long-term trends.”                           | window `AVG(order_value) OVER (PARTITION BY segment ORDER BY month ROWS BETWEEN 5 PRECEDING AND CURRENT ROW)`; CTE for order_value                                                      |     6      | **CUSTOMER**, **ORDERS**, **LINEITEM**                                     |
| ex81 | Identify High-Value Seasonal Segments             | “Find market segments whose average AOV in holiday quarter (Q4 1995) is at least 20% higher than their annual average.”                                         | CTE to get Q4 AOV per segment; CTE to get annual AOV; join + filter `Q4_avg >= annual_avg*1.2`                                                                                           |     6      | **CUSTOMER**, **ORDERS**, **LINEITEM**                                     |
| ex82 | Analyze Cohort Churn Rate                         | “For each customer cohort (by first purchase month), calculate the percentage of that cohort that did not place an order after three months.”                   | CTE to define cohorts + CTE for orders after three-month window + `COUNT(DISTINCT)` + division                                                                                           |     5      | **CUSTOMER**, **ORDERS**                                                   |
| ex83 | Rolling 12-Month Revenue Trend per Part Category  | “Compute a rolling 12-month sum of revenue for each part ‘brand’ (first 10 characters of P_NAME) to spot upward or downward trends.”                           | derive `brand = SUBSTR(P_NAME, 1, 10)`; window `SUM(revenue) OVER (PARTITION BY brand ORDER BY month ROWS BETWEEN 11 PRECEDING AND CURRENT ROW)`                                         |     6      | **PART**, **LINEITEM**, **ORDERS**                                         |
| ex84 | Year-Over-Year Market Segment Market Share        | “For each market segment, calculate revenue share in 1996 vs 1995, then rank segments by increase in share.”                                                    | two CTEs (1995 revenue per segment; 1996 revenue per segment) → join → compute share difference → window `RANK()`                                                                        |     7      | **CUSTOMER**, **ORDERS**, **LINEITEM**                                     |
| ex85 | LTV Comparison Between Early vs. Late Cohorts     | “Compare average lifetime value (first 12 months cumulative revenue) of customers acquired in Q1 1995 vs Q1 1996 to assess acquisition strategy effectiveness.” | CTE for cohort assignment; window `SUM(...) OVER (PARTITION BY cohort ORDER BY month ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)` → filter to first 12 months → average per cohort |     7      | **CUSTOMER**, **ORDERS**, **LINEITEM**                                     |
| ex86 | Detect Declining Part Demand                      | “Identify parts whose rolling 6-month revenue in 1996 dropped by > 30% compared to the preceding 6 months, signaling declining demand.”                         | window `SUM(revenue) OVER (PARTITION BY part ORDER BY month RANGE BETWEEN INTERVAL ‘6’ MONTH PRECEDING AND INTERVAL ‘1’ MONTH PRECEDING)`; then compare to current 6-month sum           |     7      | **PART**, **LINEITEM**, **ORDERS**                                         |

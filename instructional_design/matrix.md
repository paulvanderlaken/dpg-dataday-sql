# Full-Day SQL Workshop Matrix – Core & Stretch Paths

## Part 1

#### Beginner → Intermediate

| Ex # | Title                                | Business Question                                                                                  | SQL Concept                      | Difficulty | Dataset Familiarity Focus                                | Track    | Core/Stretch | Stretch/Core Notes                                                  |
|:----:|--------------------------------------|----------------------------------------------------------------------------------------------------|----------------------------------|:----------:|----------------------------------------------------------|----------|:-------------:|------------------------------------------------------------------------|
| ex01 | Top 10 Customers by Balance          | “Which customers should we prioritize for a loyalty program based on balances?”                   | `SELECT` + `ORDER BY` + `LIMIT`  |     2      | **CUSTOMER**: C_CUSTKEY, C_NAME, C_ACCTBAL                | Part 1   | Core         | Introduces sorting and value-based prioritization                   |
| ex02 | Filter Q1 Orders with Priority | “Which high-priority orders were placed in Q1 1995?” | `WHERE` with `AND`, date filtering |      2     | **ORDERS**: O\_ORDERDATE, O\_ORDERPRIORITY | Part 1 |     Core     | Adds basic filtering and date filter logic |
| ex03 | Top 3 Orders from the BUILDING Segment | “Which high-value orders came from customers in the BUILDING segment?” | `JOIN` + `WHERE` + `ORDER BY` + `LIMIT` | 2 | **ORDERS**, **CUSTOMER** | Part 1 | Core | Builds on filtering (ex02) and introduces basic `JOIN` + ranking pattern |
| ex04 | Count Customers by Segment | “How many customers belong to each market segment?” | `GROUP BY` + `COUNT(*)` |      2     | **CUSTOMER**: C\_MKTSEGMENT | Part 1 |     Core     | Introduces grouping logic; prep for later aggregation |
| ex05 | High-Quantity or Low-Price Lineitems | “Which line items qualify for bulk discounts or promotions?”                                      | `WHERE` with `AND/OR`            |     2      | **LINEITEM**: L_QUANTITY, L_EXTENDEDPRICE, L_DISCOUNT    | Part 1   | Core         | Filtering using logical operators                                   |
| ex06 | Compare Table Sizes – Parts vs Suppliers | “How many records exist in the PART and SUPPLIER tables?”                        | `COUNT(*)` + `UNION ALL` + aliasing          |     2      | **PART**, **SUPPLIER**                              | Part 1   | Stretch      | Replaces trivial LIMIT query with comparative summary using derived labels           |
| ex07 | Find Smallest Parts with Longest Names   | “Which small parts have the longest names?”                                      | `ORDER BY` + `LENGTH()` + aliasing + `LIMIT` |     3      | **PART**: P_NAME, P_SIZE                            | Part 1   | Stretch      | Extends sorting with derived columns and mixed ASC/DESC logic                         |
| ex08 | Count Orders Containing Almond Products  | “How many unique orders included a part with ‘almond’ in its name?”             | `JOIN`, `ILIKE`, `COUNT(DISTINCT)`           |     2      | **PART**, **LINEITEM**                             | Part 1   | Stretch      | Pattern match across join; simplified customer-product linkage                        |
| ex09 | Suspected Suppliers with Missing Comments      | “Identify suppliers lacking commentary.”                                                          | `IS NULL` / `IS NOT NULL`        |     1      | **SUPPLIER**: S_SUPPKEY, S_NAME, S_COMMENT                | Part 1   | Stretch      | Introduces NULL logic                                               |
| ex10 | Compute Price + Tax                  | “What would each line item cost including a 5% tax?”                                              | Arithmetic in `SELECT`           |     2      | **LINEITEM**: L_EXTENDEDPRICE, basic math expr           | Part 1   | Stretch      | Applies calculations in SELECT                                      |

----

#### Intermediate -> Advanced

| Ex # | Title                                  | Business Question                                                                                                            | SQL Concept                           | Difficulty | Dataset Familiarity Focus                                             | Track    | Core/Stretch | Stretch/Core Notes                                                  |
|:----:|----------------------------------------|------------------------------------------------------------------------------------------------------------------------------|---------------------------------------|:----------:|------------------------------------------------------------------------|----------|:-------------:|------------------------------------------------------------------------|
| ex11 | Revenue by Part and Discount Tier      | “Which parts generated the most revenue in 1998, and how does this vary by discount tier?”                               | `GROUP BY` + `SUM` + expression logic |     4      | **LINEITEM**: P_PARTKEY, L_EXTENDEDPRICE, L_DISCOUNT, date filter     | Part 1   | Core         | Builds on beginner aggregation with derived column logic             |
| ex12 | High-Volume Parts with Tiered Revenue  | “Which parts sold ≥ 1,000 units and generated over $100K in revenue?”                                                       | `HAVING` on multiple aggregates       |     5      | **LINEITEM**: aggregate quantity and extended price                   | Part 1   | Core         | Dual filters on aggregates; sharpens business criteria               |
| ex13 | Orders per Customer in 1995            | “List each customer's orders placed in 1995, including name, nation, and order date.”                                       | `INNER JOIN` + date filtering         |     4      | **ORDERS**, **CUSTOMER**, **NATION**                                 | Part 1   | Core         | Builds on JOINs by adding filtering and 3-table logic                |
| ex14 | Detailed Order Feed with Derived Cost  | “Build a full order-detail feed including extended price after discount for each item.”                                     | Multi-table `JOIN` + expressions      |     5      | **LINEITEM**, **ORDERS**, **PART**                                   | Part 1   | Core         | Combines joins and column derivations                                |
| ex15 | Customers with Recency and Order Count| “For each customer, show their most recent order date and total number of orders.”                                          | Subquery in `FROM` + `JOIN`           |     6      | **CUSTOMER**, **ORDERS**                                             | Part 1   | Core         | Recency logic + aggregation per customer                             |
| ex16 | Rank Orders with Total Spend           | “Rank each customer's orders by total spend (including discount), from highest to lowest.”                                  | `ROW_NUMBER()` OVER () + expression   |     6      | **ORDERS**, **LINEITEM**                                             | Part 1   | Core         | Extends ranking with computation                                     |
| ex17 | Supplier-Part List with Cost Flag      | “Generate a supplier-part listing and flag if the supply cost is above average for that part.”                              | `WITH` / CTE + comparison to AVG()    |     6      | **PARTSUPP**, **PART**, **SUPPLIER**                                 | Part 1   | Stretch      | Adds conditional logic to CTE use                                    |
| ex18 | Rewrite Scalar Subquery to Count Lineitems per Order | “Rewrite an inefficient per-order scalar subquery that counts line items using a `JOIN` and `GROUP BY`.” | Scalar subquery vs `GROUP BY` rewrite | 6 | **ORDERS**, **LINEITEM** | Part 1 | Stretch | Reinforces performance-minded thinking by replacing scalar subquery with set-based aggregation |
| ex19 | Deep Discount Lineitems per Order      | “Find the top 5 line items per order with the highest discount rates above 10%.”                                            | `RANK()` + `PARTITION BY` + filter    |     6      | **LINEITEM**                                                         | Part 1   | Stretch      | Builds on window + conditional filtering                             |
| ex20 | Rolling Daily Revenue Since Jan 1 1996 | “Show daily cumulative sales for all orders shipped since January 1, 1996.”                                                 | `SUM() OVER (ORDER BY)` + date filter |     6      | **LINEITEM**, **ORDERS**                                             | Part 1   | Stretch      | Builds on cumulative logic with filtered timeframe                   |


#### Advanced -> Expert

| Ex # | Title                                              | Business Question                                                                                                                                           | SQL Concepts                                                                                               | Difficulty | Dataset Familiarity Focus                                                                                                            | Track    | Core/Stretch | Stretch/Core Notes                                                  |
|:----:|----------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|:----------:|---------------------------------------------------------------------------------------------------------------------------------------|----------|:-------------:|------------------------------------------------------------------------|
| ex21 | Customer Cohort Revenue Growth                     | “Compare total revenue over time for each customer cohort (by first-purchase month).”                                                                      | CTEs, Window functions (`SUM OVER`, `ROWS BETWEEN`), date bucketing, joins                                              |     8      | **CUSTOMER → ORDERS → LINEITEM**                                                                           | Part 1   | Core         | Cohorting, date-bucketing, cumulative windows – essential pattern     |
| ex22 | Top 3 Parts by Revenue in Each Region              | “Find the highest-revenue parts in each region.”                                                                                                           | Multi-level window (`RANK()`), hierarchical joins, CTEs                                                                |     8      | **REGION → NATION → SUPPLIER → PARTSUPP → LINEITEM**                                                      | Part 1   | Core         | Advanced join traversal + partitioned ranking                         |
| ex23 | Rolling 3-Month Order Momentum by Segment | “How do different market segments ramp up in order activity over time, based on rolling 3-month order averages?” | `DATE_TRUNC`, `JOIN`, `GROUP BY`, `SUM() OVER (…)`, `ROWS BETWEEN` |     7      | **CUSTOMER**, **ORDERS** | Part 1   | Core         | Segment-level windowed analysis; more meaningful trends than sharp MoM acceleration |
| ex24 | Top 10 Customers per Segment – Deep Dive (1995) | “Who were the top 10 customers by revenue per segment in 1995, and how do their order patterns and discount behavior compare?” | `JOIN`, `GROUP BY`, `SUM()`, `COUNT()`, `AVG()`, `RANK() OVER (PARTITION BY …)` | 7 | **CUSTOMER**, **ORDERS**, **LINEITEM** | Part 1 | Stretch | Rich customer profiling using multi-metric aggregation and per-segment ranking |
| ex25 | High/Low Discounting Suppliers per Segment | “Which suppliers gave unusually high or low discounts to the top 10 customers in each segment during 1995?” | `JOIN`, `GROUP BY`, `AVG()`, `STDDEV()`, `CASE`, `RANK()` | 9 | **LINEITEM**, **ORDERS**, **CUSTOMER**, **SUPPLIER** | Part 1 | Stretch | Statistical outlier detection scoped to top customers in each segment |

---

## Part 2

### Track 1: SQL Detective

#### Beginner → Intermediate

| Ex # | Title                                        | Business Question                                                                                     | SQL Concept                         | Difficulty | Dataset Familiarity Focus                                           | Track         | Core/Stretch | Stretch/Core Notes                                                  |
|:----:|----------------------------------------------|-------------------------------------------------------------------------------------------------------|-------------------------------------|:----------:|---------------------------------------------------------------------|---------------|:-------------:|------------------------------------------------------------------------|
| ex26 | Tag Food-Related Parts                       | “Which parts in our catalog are named after common food items like almond or tomato?”                | `CASE` + `ILIKE` + `GROUP BY`       |     3      | **PART** (P_NAME)                                                  | SQL Detective | Core         | Label parts with food terms; builds logic for unstructured pattern tagging |
| ex27 | Customers Without Any Orders                 | “Which customers appear in our system but have never placed an order?”                               | `LEFT JOIN` + `IS NULL`             |     3      | **CUSTOMER**, **ORDERS**                                           | SQL Detective | Core         | Classic anti-join for missing relationships; simpler integrity check         |
| ex28 | Parts Never Sold in 1996                     | “Which parts were never sold in the year 1996?”                                                     | `LEFT JOIN`, date filtering         |     4      | **PART**, **LINEITEM**                                            | SQL Detective | Core         | Time-bound anti-join with date filters                                 |
| ex29 | Suspicious High-Discount, High-Quantity Items | “Which line items have quantity > 45 and discount > 8%?”                                          | `WHERE` compound filter             |     4      | **LINEITEM**                                                     | SQL Detective | Core         | Compound numeric filter to detect anomalous sales                     |
| ex30 | Top 0.1% Largest Orders by Revenue          | “Which orders fall in the top 0.1% by total net revenue?” Includes label column `order_category`.    | `PERCENTILE_CONT`, `WITH`, `JOIN`   |     4      | **LINEITEM**                                                    | SQL Detective | Core         | Percentile filtering with labeling; bonus for bottom 0.1% orders       |

#### Intermediate → Advanced

| Ex # | Title                                                  | Business Question                                                                                                                               | SQL Concept                                                                                  | Difficulty | Dataset Familiarity Focus                                                                                             | Track         | Core/Stretch | Stretch/Core Notes                                                                 |
|:----:|--------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------|:----------:|------------------------------------------------------------------------------------------------------------------------|---------------|:-------------:|--------------------------------------------------------------------------------------|
| ex36 | Dormant High-Balance Customers                         | “Which customers with high balances have placed very few orders?”                                                                               | `JOIN`, `GROUP BY`, window `RANK()`                                                          |     5      | **CUSTOMER**, **ORDERS**, **LINEITEM**                                                                                 | SQL Detective | Core         | Combines financial outlier flag with behavioral inactivity                        |
| ex38 | Excess Time Between Consecutive Orders                 | “Which customers have gaps >180 days between their orders?”                                                                                     | `LAG()`, `DATEDIFF()`, window ordering                                                       |     5      | **ORDERS**                                                                                                             | SQL Detective | Core         | Temporal anomaly using date differences and window functions                      |
| ex39 | Discount Outlier Detection via Z-Score                 | “Which line items have discounts more than 2 standard deviations above the mean?”                                                              | Subquery, `AVG`, `STDDEV`, z-score computation                                               |     6      | **LINEITEM**                                                                                                           | SQL Detective | Core         | Numeric anomaly detection using statistical thresholds                            |
| ex41 | Order Revenue Mismatch                                 | “Which orders have a total price different from the sum of their discounted line items?”                                                        | `GROUP BY`, `SUM()`, cross-table comparison                                                  |     5      | **ORDERS**, **LINEITEM**                                                                                               | SQL Detective | Stretch      | Reconciliation logic across header vs detail level metrics                        |
| ex42 | Market Coverage Gaps: Sold in Germany but Not France   | “Which parts have been sold in Germany but never in France?”                                                                                    | `JOIN`, filter by `N_NAME`, `NOT IN` or `NOT EXISTS`                                         |     6      | **LINEITEM**, **ORDERS**, **CUSTOMER**, **NATION**                                                                     | SQL Detective | Stretch      | Valid anti-join scenario framed as geographic coverage check                      |

---
### Track 2: Query Optimizer

#### Beginner → Intermediate

| Ex # | Title                                                | Business Question                                                               | SQL Concept                               | Difficulty | Dataset Focus            | Track           | Core/Stretch | Notes                                                                                            |
| ---- | ---------------------------------------------------- | ------------------------------------------------------------------------------- | ----------------------------------------- | ---------- | ------------------------ | --------------- | ------------ | ------------------------------------------------------------------------------------------------ |
| ex46 | Selective Customer Data Extraction                   | "Extract `C_NAME`, `C_ACCTBAL`, and `C_MKTSEGMENT` for 'AUTOMOBILE' customers, joined with orders." | Column projection + `WHERE` + join       | 3          | **CUSTOMER**, **ORDERS** | Query Optimizer | Core         | Adds join with dual early filters; highlights pushdown and targeted output.                     |
| ex47 | Early Order Filtering with Date Range                | "Retrieve all orders placed in March of 1995 and 1996, efficiently."            | `WHERE` with compound ranges, filter pushdown | 3       | **ORDERS**               | Query Optimizer | Core         | Contrast between date function vs range filter logic; enables partition pruning across years.  |
| ex48 | Top 5 Most Expensive Line Items in Q2 1995           | “Which individual line items shipped in Q2 1995 had the highest net value?”         | `ORDER BY`, `LIMIT`, early filter + CTE | 3          | **LINEITEM**, **ORDERS**     | Query Optimizer | Core         | Focuses on limiting early before joins; teaches slice-then-enrich pattern to reduce compute cost. |
| ex49 | Flagging Large or Valuable Shipments                 | “Which line items represent large-volume or high-value shipments, and how can we retrieve them efficiently?” | `UNION ALL` vs `WHERE`, column projection     | 3          | **LINEITEM**                                             | Query Optimizer | Core         | Highlights inefficiency of using UNION ALL instead of single-pass OR filter; reinforces scan reduction |
| ex50 | Filter First, Not After the Join                     | “How can we avoid processing unnecessary rows when only certain flagged line items are relevant?”            | `CASE`, filter pushdown, CTE, early filtering | 4          | **LINEITEM**, **ORDERS**                                 | Query Optimizer | Core         | Shows inefficiency of flagging and joining before filtering; teaches filter placement in layered queries |
| ex51 | LIKE vs ILIKE Pattern Performance                    | “How many parts have names containing ‘green’? Explore performance difference using `LIKE` vs `ILIKE`.” | Pattern search inefficiency          | 4     | **PART**                 | Query Optimizer | Core         | Demonstrates scan cost with `%text%` pattern matching            |
| ex52 | Rewrite IN-SELECT to Join                            | “List all customers who placed an order in 1995 — once using `IN (SELECT)` and once with a `JOIN`.”     | Subquery vs Join                     | 4     | **CUSTOMER**, **ORDERS** | Query Optimizer | Core         | Direct comparison of subquery vs join performance                |
| ex53 | Fix the Filters — Cleaning Up a Misfired Query | “How many parts are anodized, non-promotional, include green in their name, mention a key metal, and are in the bottom 10% of prices?” | `ILIKE`, `NOT ILIKE`, `OR`, `PERCENTILE_CONT`, `WITH`, `IN` query cleanup | 4 | **PART** | Query Optimizer | Core | Combines logic correction with planning improvement; starts from a broken analyst query that uses wrong filters, scalar subqueries, and ungrouped ORs |
| ex54 | CASE WHEN vs Lookup Table                            | “Map customer segments to broader tiers using `CASE WHEN`. Then try replacing this with a small join.”  | CASE logic vs mapping table          | 4     | **CUSTOMER**             | Query Optimizer | Core         | Encourages dimensional joins over hardcoded logic                |


#### Intermediate → Advanced

| Ex # | Title                                         | Business Question                                                                               | SQL Concept                            | Difficulty | Dataset Familiarity Focus              | Track           | Core/Stretch | Stretch/Core Notes                                                             |
| :--: | --------------------------------------------- | ----------------------------------------------------------------------------------------------- | -------------------------------------- | :--------: | -------------------------------------- | --------------- | :----------: | ------------------------------------------------------------------------------ |
| ex57 | Cost of SELECT \* vs Projected Columns        | “Compare performance of `SELECT *` vs selected fields in a large join.”                         | Column projection vs `*`               |      4     | **ORDERS**, **LINEITEM**               | Query Optimizer |     Core     | Reinforces column pruning and unnecessary scan awareness.                      |
| ex58 | Optimized Join Order with Early Filtering     | “Join CUSTOMER → ORDERS → LINEITEM starting with filtered customers.”                           | Join order + filter placement          |      5     | **CUSTOMER**, **ORDERS**, **LINEITEM** | Query Optimizer |     Core     | Showcases filter pushdown benefits on multi-join plans.                        |
| ex59 | QUALIFY for Top Revenue Line Item             | “Get highest revenue line item per order using `QUALIFY`.”                                      | `ROW_NUMBER()`, `QUALIFY`              |      5     | **LINEITEM**                           | Query Optimizer |     Core     | Uses efficient window filtering logic instead of nested subqueries.            |
| ex60 | GROUP BY vs Nested Aggregates                 | “Compare nested vs flat aggregation to compute revenue per part and overall total.”             | GROUP BY simplification                |      5     | **LINEITEM**                           | Query Optimizer |     Core     | Demonstrates unnecessary nesting logic and over-aggregation cost.              |
| ex61 | Rewrite Correlated Subquery to Set-Based Join | “Count line items per order using `GROUP BY` instead of correlated subquery.”                   | Join-based rewrite of row-by-row logic |      5     | **ORDERS**, **LINEITEM**               | Query Optimizer |    Stretch   | Covers classic subquery inefficiency and refactoring.                          |
| ex62 | Aggregate on High vs Low Cardinality Columns  | “Compare aggregation speed when using `L_PARTKEY` vs `L_ORDERKEY` vs `L_LINENUMBER`.”           | Aggregation design tradeoffs           |      5     | **LINEITEM**                           | Query Optimizer |    Stretch   | Highlights explosion risk from high-cardinality groupings.                     |
| ex63 | Filter Before Window Function                 | “Find top 3 discounted items per order, but only for orders placed after 1996.”                 | Filter → window → `QUALIFY`            |      6     | **ORDERS**, **LINEITEM**               | Query Optimizer |    Stretch   | Reinforces importance of narrowing partitions early.                           |
| ex64 | UNION vs UNION ALL Comparison                 | “Merge two order datasets using `UNION` and `UNION ALL`. Compare performance and result count.” | Deduplication logic and cost           |      5     | **ORDERS**                             | Query Optimizer |    Stretch   | Shows impact of default `DISTINCT` behavior in `UNION`.                        |
| ex65 | Use of EXPLAIN to Diagnose Join Behavior      | “Use `EXPLAIN` to understand join behavior and scan size between ORDERS and LINEITEM.”          | Snowflake EXPLAIN plan inspection      |      4     | **ORDERS**, **LINEITEM**               | Query Optimizer |    Stretch   | Directs learners into platform introspection for optimization.                 |
| ex66 | Materialized CTE vs Duplicated Logic          | “Compare performance of a reused CTE vs repeating its logic in a long query.”                   | CTE materialization vs duplication     |      6     | **ORDERS**, **LINEITEM**               | Query Optimizer |    Stretch   | Teaches when and why reuse may benefit Snowflake compute plans.                |
| ex67 | Cost-Aware Join Strategy Evaluation           | “Estimate cost impact of filtering before vs after join using scan metrics and estimated rows.” | Snowflake compute cost tradeoffs       |      6     | **CUSTOMER**, **ORDERS**, **LINEITEM** | Query Optimizer |    Stretch   | Guides performance reasoning grounded in Snowflake credits and planner output. |


---

### Track 3: Business Strategist

#### Beginner → Intermediate

| Ex # | Title                                | Business Question                                                                                     | SQL Concept                                                                                       | Difficulty | Dataset Familiarity Focus                                      | Track              | Core/Stretch | Notes |
|:----:|--------------------------------------|-------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------|:----------:|--------------------------------------------------------------|--------------------|:-------------:|-------|
| ex67 | Total Revenue per Entity             | “Which entities (e.g. customers or suppliers) generated the most revenue across all orders?”          | `JOIN` + `GROUP BY` + `SUM(L_EXTENDEDPRICE*(1-L_DISCOUNT))`                                      | 3          | **CUSTOMER**, **ORDERS**, **LINEITEM**                        | Business Strategist | Core         | Revenue logic decoupled from customer domain — applicable broadly |
| ex68 | Monthly Revenue Trend by Category    | “How does total revenue evolve over time across key categories?”                                     | `JOIN`, `DATE_TRUNC`, `GROUP BY`                                                                  | 3          | **CUSTOMER**, **ORDERS**, **LINEITEM**                        | Business Strategist | Core         | Time bucketing + category logic with trend output |
| ex69 | Average Value per Transaction Entity | “Which entities tend to produce higher-value transactions on average?”                               | Subquery or CTE: order → average per entity                                                      | 3          | **CUSTOMER**, **ORDERS**, **LINEITEM**                        | Business Strategist | Core         | Aggregation at transaction level to evaluate entity behavior |
| ex70 | Entity Count by Group Over Time      | “How has the number of active entities (e.g., customers) per group changed over time? Present years as columns.” | `JOIN`, `DATE_TRUNC`, `COUNT(CASE WHEN …)`, pivot-like logic            | 4 | **CUSTOMER**, **ORDERS** | Business Strategist | Core | Introduces pivoting via conditional aggregates for trend tables |
| ex71 | Top 5 Items by Revenue in a Time Period | “Which items generated the most revenue in a given year?”                                            | `JOIN` + `GROUP BY` + `ORDER BY` + `LIMIT`                                                       | 4          | **PART**, **ORDERS**, **LINEITEM**                          | Business Strategist | Stretch      | Generalized top-N revenue analysis for products, features, etc. |

---

#### Intermediate → Advanced

| Ex # | Title                                       | Business Question                                                                                              | SQL Concept                                                                                                           | Difficulty | Dataset Familiarity Focus                                      | Track              | Core/Stretch | Notes |
|:----:|---------------------------------------------|------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------|:----------:|--------------------------------------------------------------|--------------------|:-------------:|-------|
| ex77 | Trend Since First Appearance                | “How does revenue evolve in the 12 months after an entity first appears?”                                       | CTE for cohorting + window `SUM()` with `ROWS BETWEEN`, date joins                                                   | 6          | **CUSTOMER**, **ORDERS**, **LINEITEM**                        | Business Strategist | Core         | Lifecycle trend view independent of domain; CTE + rolling sum pattern |
| ex78 | Top-N Contributors by Region                | “Which items contribute most revenue within each region?”                                                       | Multi-level `JOIN`, `RANK() OVER (PARTITION BY …)`                                                                   | 7          | **LINEITEM**, **SUPPLIER**, **NATION**, **REGION**, **PART** | Business Strategist | Core         | Geographic + contributor breakdown via partitioned ranking |
| ex79 | Detect Fast-Changing Groups Over Time       | “Which groups show revenue growth >10% between periods?”                                                        | `DATE_TRUNC`, `LAG()`, ratio filter                                                                                   | 6          | **CUSTOMER**, **ORDERS**, **LINEITEM**                      | Business Strategist | Core         | Comparative time-series growth pattern |
| ex80 | Rolling 6-Month Averages                    | “How does average transaction value evolve in a rolling 6-month window?”                                        | Window `AVG()` + `ROWS BETWEEN 5 PRECEDING` + joins                                                                  | 6          | **CUSTOMER**, **ORDERS**, **LINEITEM**                      | Business Strategist | Core         | Clean metric smoothing using rolling windows |
| ex81 | Group Seasonality Analysis                  | “Which groups show a seasonal spike in Q4 versus their yearly average?”                                         | CTE: Q4 + annual average → join → delta logic                                                                        | 6          | **CUSTOMER**, **ORDERS**, **LINEITEM**                      | Business Strategist | Core         | Detects relative seasonal changes via aggregate comparison |
| ex82 | Multi-Transaction Rate Within 90 Days       | “What % of entities make more than one transaction within 90 days of their first?”                              | CTE + `MIN()`, `DATEDIFF`, `COUNT()` per entity → filter → ratio                                                     | 5          | **CUSTOMER**, **ORDERS**                                    | Business Strategist | Core         | General funnel logic framed in neutral temporal behavior |
| ex83 | Rolling Trends by Attribute Group           | “Track rolling 12-month revenue trends by any attribute (e.g., brand, category).”                               | `SUBSTR()` or `CASE` for attribute → `SUM() OVER` with time frame                                                    | 6          | **PART**, **LINEITEM**, **ORDERS**                          | Business Strategist | Stretch      | Dynamic grouping + long-window trends |
| ex84 | Year-over-Year Share Change by Group        | “Which groups gained or lost revenue share between two years?”                                                  | Two CTEs → join → compute deltas → `RANK()`                                                                          | 7          | **CUSTOMER**, **ORDERS**, **LINEITEM**                      | Business Strategist | Stretch      | Share of total metric comparison across time periods |
| ex85 | Cohort Comparison Across Time               | “Compare first-year performance across cohorts who entered in each quarter of 1995 and 1996. Include order count, total revenue, and AOV.” | CTEs for cohort buckets → `SUM()`/`COUNT()`/`AVG()` → comparative output | 8 | **CUSTOMER**, **ORDERS**, **LINEITEM** | Business Strategist | Stretch | Multi-KPI cohort comparison across two periods |
| ex86 | Non-Linear Decline Pattern Detection        | “Identify items that show a drop of over 30% in revenue between any two non-consecutive rolling 6-month windows.” | Extended window logic + multiple lag comparisons + flag creation        | 8 | **PART**, **LINEITEM**, **ORDERS** | Business Strategist | Stretch | Complex trend anomaly detection via multi-window logic |
